---
layout: note_page
title: 라이브러리와 링킹
tags: [Programming]
category: "Programming"
---

컴파일 과정에서 수행되는 링킹과정과 링킹에 사용되는 라이브러리에 대한 내용을 다룬다.

## 1. 컴파일

링킹과 라이브러리에 대해 알아보기 전에 먼저 컴파일(Compile)에 대해서 간략하게 정리한다.

컴파일은 사람이 작성한 코드를 기계가 이해할 수 있는 `기계어`로 변환하는 과정을 말한다. 컴파일 과정은 다음의 그림에서 `Source File`들을 `Object File`로 바꿔주는 과정에 해당한다.

<img src="/assets/img/posts/230204_compilation.png">

사람의 언어로 작성된 코드를 `어셈블리어`로 변환한 `어셈블리 파일(*.s)`로 변환하고, 이를 `어셈블러`를 이용하여 기계어에 해당하는 `오브젝트 파일(*.o)`로 변환하는 `어셈블리` 과정을 거친다.

> 어셈블리어는 기계어와 일대일 대응되는 로우 레벨 프로그래밍 언어이다. 컴퓨터 구조에 따라 사용하는 기계어가 달라지며, 따라서 기계어에 대응되어 만들어지는 어셈블리어도 각각 다르게 된다.

> 컴파일 과정을 `전처리`, `컴파일`, `어셈블`, `링크`의 과정으로 세분화할 수 있지만, 여기서는 간략한 내용만을 다룬다.

## 2. 링킹

링킹은 `링커`를 이용하여 컴파일 과정 이후에 생성된 오브젝트 파일들과 해당 프로그램에서 사용되는 `라이브러리`들을 링크하여 `실행 파일(*.exe)`을 만드는 과정이다.

이 실행 파일이 전체 빌드 과정의 산출물이며, 사람이 작성한 코드를 실행할 수 있는 결과물이 된다.

## 3. 라이브러리

그럼 링킹의 단계에서 사용되는 오브젝트 파일은 사람이 작성한 코드를 기계어로 변환한 파일이지만, 라이브러리는 무엇일까?

라이브러리란 소프트웨어의 구성요소 중 한가지로, API를 기반으로 대상 환경(플랫폼)에서 바로 실행될 수 있도록 모듈화된 프로그램 모음이다. 라이브러리는 혼자서 동작하는 완전한 프로그램이 아닌, 특정한 부분 기능만을 수행하도록 제작된, 컴파일되어 기계어의 형태로 (또는 대상 플랫폼에 따라서는 바이트코드로) 존재하는 프로그램이다.

이 라이브러리는 링킹 방식에 따라 두 가지로 나뉜다. `정적 링킹`을 위해 사용되는 `정적 라이브러리`와 `동적 링킹`을 위해 사용되는 `동적 라이브러리`로 나뉜다.

<img src="/assets/img/posts/230204_library.png">

### 3.1 정적 링킹과 정적 라이브러리

정적 라이브러리는 정적 링킹 과정에서 사용되는 라이브러리로, 확장자는 윈도우에서는 `*.lib`, 리눅스에서는 `*.a`으로 사용된다. 정적 링킹은 링킹할 때 정적 라이브러리를 복사하는 방식으로, 링킹하는 시점의 라이브러리를 그대로 사용할 수 있다. 이는 이식성이 좋고 안정적으로 링킹을 할 수 있다. 또한 프로그램의 속도도 빠르다.

하지만, 이러한 장점은 단점을 야기시키는데, 복사해서 사용하기 때문에 실행 파일의 크기가 커지고, 같은 라이브러리를 여러 프로그램에 동시에 사용하는 경우, 모든 프로그램에서 복사해서 사용하므로 메모리 효율이 좋지 않다. 또한, 라이브러리가 수정되면, 파일 전체를 다시 컴파일해야 한다. 

### 3.2 동적 링킹과 동적 라이브러리

동적 라이브러리는 동적 링킹 과정에서 사용되는 라이브러리로, 확장자는 윈도우에서는 `*.dll`, 리눅스에서는 `*.so`으로 사용된다. 동적 링킹은 링킹할 때 동적 라이브러리의 주소만 가져오는 방식으로, 런타임 시점의 라이브러리를 사용할 수 있다. 이는 정적 링킹과 다르게 복사하지 않으므로, 메모리의 효율이 좋고, 라이브러리가 수정되면 다시 컴파일할 필요가 없다.

하지만 이러한 방식은 단점을 가지는데, 매번 주소를 찾아가야 하기 때문에 오버헤드가 존재하고, 런타임 순간의 라이브러리를 사용하므로 라이브러리의 버전이 맞지 않는 등의 문제가 발생할 수 있다. 이는 안정성을 떨어뜨리고, 이식성이 떨어지게 만든다.

## 참고문헌

- [라이브러리(Library)에 대한 이해](https://bradbury.tistory.com/224)
- [컴파일(Compile)에 대한 이해](https://bradbury.tistory.com/226)
- [c언어 컴파일 과정[링킹,컴파일,라이브러리,오브젝트]](https://coding-lks.tistory.com/105)
- [[Linking] 정적 링킹과 동적 링킹의 차이](https://live-everyday.tistory.com/69)
- [링킹 (Dynamic Linking vs Static Linking)](https://thisisprogrammingworld.tistory.com/m/175)
- [Compilation](https://www.webopedia.com/definitions/compilation/)
- [어셈블리어](https://ko.wikipedia.org/wiki/%EC%96%B4%EC%85%88%EB%B8%94%EB%A6%AC%EC%96%B4)
- [라이브러리 (컴퓨팅)](https://ko.wikipedia.org/wiki/%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC_(%EC%BB%B4%ED%93%A8%ED%8C%85))
- [라이브러리](https://namu.wiki/w/%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC)
- [C++ 표준 라이브러리](https://ko.wikipedia.org/wiki/C%2B%2B_%ED%91%9C%EC%A4%80_%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC)